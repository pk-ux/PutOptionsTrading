"""
Minimal debug app to test Streamlit Cloud deployment
- Portions generated by AI
"""

import streamlit as st

st.set_page_config(page_title="Debug Test", page_icon="ðŸ”§")

st.title("Debug Test - Streamlit Cloud")
st.success("If you can see this, Streamlit is working!")

# Test imports one by one
import_status = {}

try:
    import pandas as pd
    import_status["pandas"] = "OK"
except Exception as e:
    import_status["pandas"] = f"FAIL: {e}"

try:
    import numpy as np
    import_status["numpy"] = "OK"
except Exception as e:
    import_status["numpy"] = f"FAIL: {e}"

try:
    import requests
    import_status["requests"] = "OK"
except Exception as e:
    import_status["requests"] = f"FAIL: {e}"

try:
    from dotenv import load_dotenv
    import_status["python-dotenv"] = "OK"
except Exception as e:
    import_status["python-dotenv"] = f"FAIL: {e}"

try:
    import scipy
    import_status["scipy"] = "OK"
except Exception as e:
    import_status["scipy"] = f"FAIL: {e}"

try:
    import yfinance as yf
    import_status["yfinance"] = "OK"
except Exception as e:
    import_status["yfinance"] = f"FAIL: {e}"

try:
    from massive import RESTClient
    import_status["massive"] = "OK"
except Exception as e:
    import_status["massive"] = f"FAIL: {e}"

try:
    import os
    api_key = os.getenv('MASSIVE_API_KEY')
    if api_key:
        import_status["MASSIVE_API_KEY"] = f"Set (length: {len(api_key)})"
    else:
        import_status["MASSIVE_API_KEY"] = "NOT SET"
except Exception as e:
    import_status["MASSIVE_API_KEY"] = f"FAIL: {e}"

# Display results
st.subheader("Import Test Results")
for module, status in import_status.items():
    if "FAIL" in status or "NOT SET" in status:
        st.error(f"{module}: {status}")
    else:
        st.success(f"{module}: {status}")

# Test local module imports
st.subheader("Local Module Imports")

try:
    from massive_api_client import massive_client
    if massive_client:
        st.success("massive_api_client: OK (client initialized)")
    else:
        st.warning("massive_api_client: Loaded but client is None")
except Exception as e:
    st.error(f"massive_api_client: FAIL - {type(e).__name__}: {e}")

try:
    from options_screener import load_config
    config = load_config()
    st.success(f"options_screener: OK (loaded config with {len(config.get('data', {}).get('symbols', []))} symbols)")
except Exception as e:
    st.error(f"options_screener: FAIL - {type(e).__name__}: {e}")

st.info("All tests complete!")
