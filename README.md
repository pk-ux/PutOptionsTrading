# Put Options Screener

Interactive web application that scans put option chains for a list of stocks, computes key metrics (delta, annualized return, implied volatility), and highlights candidates that meet your custom filters. Data comes from Massive.com (professional Greeks) with Yahoo Finance as a fallback.

- Portions generated by AI

## Features

- **Professional-grade Greeks**: Delta, gamma, theta, vega directly from Massive.com API
- **Automatic fallback**: Uses Yahoo Finance when Massive.com data is unavailable
- **Responsive UI**: Works on desktop and mobile browsers
- **Real-time news**: Latest news headlines for screened tickers
- **Configurable filters**: DTE, volume, open interest, return %, assignment probability

## Architecture

```
PutOptionsTrading/
├── frontend/              # React + TypeScript + Vite
│   ├── src/
│   │   ├── components/    # Reusable UI components
│   │   ├── pages/         # Route pages
│   │   ├── hooks/         # Custom React hooks
│   │   ├── api/           # API client
│   │   ├── stores/        # Zustand state management
│   │   └── types/         # TypeScript types
│   └── package.json
│
├── backend/               # FastAPI application
│   ├── app/
│   │   ├── api/v1/        # API routes
│   │   ├── core/          # Config, database, dependencies
│   │   ├── models/        # SQLAlchemy models
│   │   ├── schemas/       # Pydantic schemas
│   │   └── services/      # Business logic
│   └── requirements.txt
│
├── shared/                # Shared Python modules
│   ├── options_screener.py
│   ├── massive_api_client.py
│   └── config.json
│
└── docker-compose.yml     # Local development setup
```

## Quick Start

### Prerequisites

- Python 3.11+
- Node.js 18+
- Massive.com API key (https://massive.com)

### Setup

1. **Clone the repo**
   ```bash
   git clone https://github.com/your-org/PutOptionsTrading.git
   cd PutOptionsTrading
   ```

2. **Create Python virtual environment**
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Windows: .venv\Scripts\activate
   ```

3. **Install backend dependencies**
   ```bash
   cd backend
   pip install -r requirements.txt
   cd ..
   ```

4. **Install frontend dependencies**
   ```bash
   cd frontend
   npm install
   cd ..
   ```

5. **Create `.env` file**
   ```bash
   MASSIVE_API_KEY=your_massive_api_key
   DATABASE_URL=sqlite:///./backend/local_test.db
   ```

### Running Locally

**Option 1: Development script (recommended)**
```bash
./scripts/dev.sh
```

**Option 2: Manual start**

Terminal 1 - Backend:
```bash
cd backend
uvicorn app.main:app --reload --port 8000
```

Terminal 2 - Frontend:
```bash
cd frontend
npm run dev
```

Then open http://localhost:5173 in your browser.

### Running with Docker

```bash
docker-compose up -d
```

Open http://localhost:3000 in your browser.

## API Endpoints

| Endpoint | Method | Auth | Description |
|----------|--------|------|-------------|
| `/health` | GET | No | Health check |
| `/api/v1/me` | GET | Yes* | Current user info + settings |
| `/api/v1/settings` | GET | Yes* | Get user settings |
| `/api/v1/settings` | PUT | Yes* | Update user settings |
| `/api/v1/screen` | POST | No* | Run options screener |
| `/api/v1/news/{symbol}` | GET | No | Get ticker news |
| `/api/v1/test-screen` | GET | No | Test screening endpoint |

*Auth is optional in Phase 1 (dev mode).

## Configuration

Default screening parameters (stored in `config.json`):

| Setting | Description | Default |
|---------|-------------|---------|
| `max_dte` | Maximum days to expiration | 45 |
| `min_dte` | Minimum days to expiration | 15 |
| `min_volume` | Minimum option volume | 10 |
| `min_open_interest` | Minimum open interest | 10 |
| `min_annualized_return` | Minimum return % | 20 |
| `max_assignment_probability` | Max probability (delta) % | 20 |

## Data Sources

- **Massive.com** (Primary): Professional Greeks from API - no local calculation
- **Yahoo Finance** (Fallback): Free data, Greeks calculated locally via Black-Scholes

## Development Phases

### Phase 1: MVP
- React frontend with full UI
- FastAPI backend with screening endpoints
- Local development without authentication
- Railway deployment configuration

### Phase 2 (Current): Authentication
- Clerk integration (Google, Apple, Email/Password)
- User settings persistence in database
- Protected routes with auth redirect
- JWT token verification in backend

### Phase 3: Production
- Stripe subscription integration
- Usage limits enforcement
- Production hardening

## Deployment

### Railway

1. Create a new project on Railway
2. Add PostgreSQL plugin
3. Deploy backend service from `backend/` directory
4. Deploy frontend service from `frontend/` directory
5. Set environment variables

See `railway.toml` for configuration.

## Environment Variables

### Backend
```
DATABASE_URL=postgresql://...
MASSIVE_API_KEY=your_key
CORS_ORIGINS=https://your-frontend-url
CLERK_SECRET_KEY=sk_live_... (Phase 2)
STRIPE_SECRET_KEY=sk_live_... (Phase 3)
```

### Frontend
```
VITE_API_URL=https://your-backend-url
VITE_CLERK_PUBLISHABLE_KEY=pk_live_... (Phase 2)
```

## Security Notes

- Keep API keys in environment variables or `.env`
- Never commit secrets to version control
- In production, restrict CORS to your frontend domain

## License

MIT
